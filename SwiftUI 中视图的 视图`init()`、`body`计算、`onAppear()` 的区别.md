# SwiftUI 中视图的 `init()`、`body`、`onAppear()` 的区别

在 SwiftUI 中，理解视图的生命周期对于正确管理状态和副作用非常关键。本文件将对比以下三个核心方法/属性：

- `init()` 构造函数
- `body` 计算属性
- `onAppear()` 生命周期钩子

---

## 👷‍♂️ `init()` 构造函数

### ✅ 作用：
表示 **视图结构体被创建** 时调用。通常用于初始化属性、执行一次性逻辑。

### 📌 特点：
- 每当 SwiftUI 判断这个视图是 **“一个新实例”** 时，会重新调用 `init()`。
- 和 SwiftUI 的 **identity** 有关：比如 `.id()` 改变，或视图条件从 false → true，会触发 `init()`。
- 不代表界面一定已经呈现，也不适合放 UI 动画或数据加载。

### 🧪 示例：
```swift
struct MyView: View {
    init() {
        print("init")
    }

    var body: some View {
        Text("Hello")
    }
}
```

---

## 🧠 `body` 计算属性

### ✅ 作用：
表示 SwiftUI 要重新计算视图的 UI 结构。只要和视图有关的状态发生变化，`body` 就会被重新调用。

### 📌 特点：
- SwiftUI 是声明式的，任何状态变化都会重新评估 `body`。
- 并 **不会重新初始化视图实例**（也就是不会调用 `init()`）；
- `body` 是 **响应式系统核心**，它会频繁执行，不要在这里写耗时或副作用逻辑。

### 🧪 示例：
```swift
@State private var count = 0

var body: some View {
    VStack {
        Text("Count: \(count)")
        Button("Add") { count += 1 } // 改变状态 → body 重新评估
    }
}
```

---

## 📢 `.onAppear()`

### ✅ 作用：
表示视图 **真正出现在屏幕上** 时调用。适合做副作用逻辑，比如网络请求、启动动画、分析埋点等。

### 📌 特点：
- 是一个 **生命周期钩子**；
- **只在视图首次呈现时触发一次**（除非视图被移除再添加）；
- 视图 body 多次更新不会重复触发；
- 可与 `.onDisappear()` 配合使用。

### 🧪 示例：
```swift
Text("Hello")
    .onAppear {
        print("视图真正显示出来了")
    }
```

---

## ✅ 三者对比表格

| 生命周期钩子 | 代表含义                     | 调用时机                               | 是否代表视图重新渲染 |
|--------------|------------------------------|----------------------------------------|----------------------|
| `init()`     | 创建视图实例                 | 每次新建视图（identity 变化）         | ❌ 否               |
| `body`       | 重新评估 UI 结构             | 每次状态变化时                         | ✅ 是               |
| `.onAppear()`| 视图首次出现在屏幕上         | 第一次显示视图时（非 body 刷新）       | ❌ 否               |

---

## 🎯 小结：

- `init()` 代表视图 **实例的初始化**；
- `body` 是 SwiftUI 的核心，用于 **响应式 UI 结构刷新**；
- `.onAppear()` 是 **视图实际挂载到屏幕上** 的标志。

这三者代表了 SwiftUI 中不同层级的生命周期，正确使用它们能让你的代码更高效、更可控。
